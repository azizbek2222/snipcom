<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>STAR MARKET</title>

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- AdsGram Interstitial -->
<script src="https://sad.adsgram.ai/js/sad.min.js"></script>

<style>
body {
    font-family: Arial;
    background: #111;
    color: white;
    padding: 20px;
}
input {
    width: 100%;
    padding: 13px;
    border-radius: 10px;
    border: none;
    margin-bottom: 20px;
    font-size: 17px;
}
.music-card {
    background: #222;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
}
.btn-download {
    margin-top: 10px;
    display: inline-block;
    padding: 8px 12px;
    background: #0af;
    color: white;
    border-radius: 8px;
    text-decoration: none;
}
</style>
</head>

<body>

<h2>STAR MARKETðŸ“¥</h2>

<input type="text" id="search" placeholder="ilova nomini yozing...">

<div id="musicList"></div>

<script>
// === ILOVALAR ROÊ»YXATI===
const musics = [
    {name: "", link: ""},
    {name: "", link: ""},
    {name: "Bitunix", link: "https://drive.google.com/file/d/1ey4-ET4Vqvw9wClZftwDZ4h1RFxSFCUS/view?usp=drivesdk"},
    {name: "HopWeb", link: "https://drive.google.com/file/d/1GUMRvMSOaRGVSY_9ZC_M8NHY-_v84mii/view?usp=drivesdk"},
    
];

// === INTERSTITIAL REKLAMA ===
function showInterstitial() {
    const AdController = window.Adsgram.init({
        blockId: "int-18178", // sizning interstitial blockId
        type: "interstitial"
    });

    AdController.show().then((result) => {
        console.log("Interstitial ad finished:", result);
    }).catch((e) => {
        console.log("Interstitial error:", e);
    });
}

// === AUTOSTART REKLAMA ===
setTimeout(showInterstitial, 1200); // sahifa ochilgandan 1.2s keyin interstitial

// === MUSIQA CHIQARISH ===
function renderList(filtered) {
    let list = document.getElementById("musicList");
    list.innerHTML = "";

    filtered.forEach(m => {
        let div = document.createElement("div");
        div.className = "music-card";
        div.innerHTML = `
            ${m.name}<br>
            <a class="btn-download" href="${m.link}" target="_blank">Yuklab olish â¬‡</a>
        `;
        list.appendChild(div);
    });

    // === YUKLAB OLISH TUGMASI BOSILISHI HISOBLASH ===
    let downloadButtons = document.querySelectorAll(".btn-download");
    let downloadCount = 0;

    downloadButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            downloadCount++;
            console.log("Yuklab olish bosildi:", downloadCount);

            if (downloadCount >= 5) {
                showInterstitial(); // 5-marta bosilganda interstitial reklama
                downloadCount = 0;
            }
        });
    });
}

renderList(musics);

// === QIDIRUV + AUTO REKLAMA 5-marta ===
let searchCount = 0;
let typingTimer;
const doneTypingDelay = 1000;

document.getElementById("search").addEventListener("input", function () {
    clearTimeout(typingTimer);
    const value = this.value.toLowerCase();

    typingTimer = setTimeout(() => {
        if (value === "") {
            renderList(musics);
            return;
        }

        const filtered = musics.filter(m => m.name.toLowerCase().includes(value));
        renderList(filtered);

        searchCount++;
        console.log("Qidiruv soni:", searchCount);

        if (searchCount >= 5) {
            showInterstitial(); // interstitial reklama
            searchCount = 0;
        }
    }, doneTypingDelay);
});
</script>

</body>
</html>